<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Benchmarking | ML Workflow for Research Scientists</title>
  <meta name="description" content="This is a tutorial for Google Colab users to contribute code to a well-structured Python project." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Benchmarking | ML Workflow for Research Scientists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a tutorial for Google Colab users to contribute code to a well-structured Python project." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Benchmarking | ML Workflow for Research Scientists" />
  
  <meta name="twitter:description" content="This is a tutorial for Google Colab users to contribute code to a well-structured Python project." />
  

<meta name="author" content="Ajinkya K Mulay" />


<meta name="date" content="2021-02-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="doc.html"/>
<link rel="next" href="putting-it-all-together.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Google Colab Workflow for <br/> Research Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-is-this-wiki-for"><i class="fa fa-check"></i>Who is this wiki for?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-wont-you-learn"><i class="fa fa-check"></i>What won’t you learn?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-will-you-learn"><i class="fa fa-check"></i>What will you learn?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>2</b> ML Setup</a><ul>
<li class="chapter" data-level="2.1" data-path="setup.html"><a href="setup.html#google-colaboratory-colab"><i class="fa fa-check"></i><b>2.1</b> Google Colaboratory (Colab)</a></li>
<li class="chapter" data-level="2.2" data-path="setup.html"><a href="setup.html#visual-studio-vs-code-local-option"><i class="fa fa-check"></i><b>2.2</b> Visual Studio (VS) Code (Local Option)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>3</b> Git, Github and Desktop management</a><ul>
<li class="chapter" data-level="3.1" data-path="git.html"><a href="git.html#using-git"><i class="fa fa-check"></i><b>3.1</b> Using Git</a><ul>
<li class="chapter" data-level="3.1.1" data-path="git.html"><a href="git.html#setting-up-a-local-repository-from-a-remote-one"><i class="fa fa-check"></i><b>3.1.1</b> Setting up a local repository from a remote one</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="git.html"><a href="git.html#using-github-and-google-colaboratory-colab"><i class="fa fa-check"></i><b>3.2</b> Using GitHub and Google Colaboratory (Colab)</a></li>
<li class="chapter" data-level="3.3" data-path="git.html"><a href="git.html#in-built-option"><i class="fa fa-check"></i><b>3.3</b> In-built option</a></li>
<li class="chapter" data-level="3.4" data-path="git.html"><a href="git.html#the-longer-option"><i class="fa fa-check"></i><b>3.4</b> The Longer Option</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="testing.html"><a href="testing.html"><i class="fa fa-check"></i><b>4</b> Unit Testing</a></li>
<li class="chapter" data-level="5" data-path="doc.html"><a href="doc.html"><i class="fa fa-check"></i><b>5</b> Documentation</a></li>
<li class="chapter" data-level="6" data-path="benchmarking.html"><a href="benchmarking.html"><i class="fa fa-check"></i><b>6</b> Benchmarking</a></li>
<li class="chapter" data-level="7" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html"><i class="fa fa-check"></i><b>7</b> Putting It All Together</a><ul>
<li class="chapter" data-level="7.1" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#workflow"><i class="fa fa-check"></i><b>7.1</b> Workflow</a></li>
<li class="chapter" data-level="7.2" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#concluding-remarks"><i class="fa fa-check"></i><b>7.2</b> Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ML Workflow for Research Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="benchmarking" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Benchmarking</h1>
<p>ML Systems get super complex very easily. You’ve to track projects, experiments within these projects, metrics inside each experiment, hyperparameters for each metric collection, and so much more. Furthermore, multiple experiment runs slow the experimentation phase and makes it harder to track the results. Recently, the ML systems got an excellent upgrade. Now, users could pipe out all the <em>super interesting stuff</em> onto a cool looking dashboard. Enter <em><a href="wandb.ai">Weights and Biases</a></em>. You not only get a free account as an academic, but you can also invite a team to collaborate! Especially if you work on research and/or in open-source. Weights and Biases (WANDB) exists to give you control of your data, store multiple experimentation runs and compare your results easily!</p>
<p>Let us look at the simplest way to get WANDB running on your project. You can find a similar code setup once you create your project on &lt;wandb.ai&gt;.</p>
<ol style="list-style-type: decimal">
<li>Init</li>
</ol>
<pre class="git"><code>pip install --upgrade wandb
wandb login your-login-code</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Sample Training Loop to log metrics</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="benchmarking.html#cb16-1"></a><span class="co"># Init wandb</span></span>
<span id="cb16-2"><a href="benchmarking.html#cb16-2"></a><span class="im">import</span> wandb</span>
<span id="cb16-3"><a href="benchmarking.html#cb16-3"></a></span>
<span id="cb16-4"><a href="benchmarking.html#cb16-4"></a><span class="co"># List of hyperparameters</span></span>
<span id="cb16-5"><a href="benchmarking.html#cb16-5"></a>config <span class="op">=</span> <span class="bu">dict</span> (</span>
<span id="cb16-6"><a href="benchmarking.html#cb16-6"></a>  learning_rate <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span id="cb16-7"><a href="benchmarking.html#cb16-7"></a>  momentum <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span id="cb16-8"><a href="benchmarking.html#cb16-8"></a>  architecture <span class="op">=</span> <span class="st">&quot;CNN&quot;</span>,</span>
<span id="cb16-9"><a href="benchmarking.html#cb16-9"></a>  dataset_id <span class="op">=</span> <span class="st">&quot;peds-0192&quot;</span>,</span>
<span id="cb16-10"><a href="benchmarking.html#cb16-10"></a>  infra <span class="op">=</span> <span class="st">&quot;AWS&quot;</span>,</span>
<span id="cb16-11"><a href="benchmarking.html#cb16-11"></a>)</span>
<span id="cb16-12"><a href="benchmarking.html#cb16-12"></a></span>
<span id="cb16-13"><a href="benchmarking.html#cb16-13"></a><span class="co"># Initialize the project with the hyperparameters and other </span></span>
<span id="cb16-14"><a href="benchmarking.html#cb16-14"></a><span class="co"># organization stuff</span></span>
<span id="cb16-15"><a href="benchmarking.html#cb16-15"></a>wandb.init(project<span class="op">=</span><span class="st">&quot;project-name&quot;</span>,</span>
<span id="cb16-16"><a href="benchmarking.html#cb16-16"></a>  notes<span class="op">=</span><span class="st">&quot;your-notes&quot;</span>,</span>
<span id="cb16-17"><a href="benchmarking.html#cb16-17"></a>  tags<span class="op">=</span>[<span class="st">&quot;baselie&quot;</span>, <span class="st">&quot;tag1&quot;</span>],</span>
<span id="cb16-18"><a href="benchmarking.html#cb16-18"></a>  config<span class="op">=</span>config,</span>
<span id="cb16-19"><a href="benchmarking.html#cb16-19"></a>  entity<span class="op">=</span><span class="st">&#39;teamname&#39;</span></span>
<span id="cb16-20"><a href="benchmarking.html#cb16-20"></a>)</span>
<span id="cb16-21"><a href="benchmarking.html#cb16-21"></a></span>
<span id="cb16-22"><a href="benchmarking.html#cb16-22"></a><span class="co"># Save your dataset to track which dataset was used in the current</span></span>
<span id="cb16-23"><a href="benchmarking.html#cb16-23"></a><span class="co"># expt</span></span>
<span id="cb16-24"><a href="benchmarking.html#cb16-24"></a>artifact <span class="op">=</span> wandb.Artifact(<span class="st">&#39;my-dataset&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="st">&#39;dataset&#39;</span>)</span>
<span id="cb16-25"><a href="benchmarking.html#cb16-25"></a>artifact.add_file(<span class="st">&#39;my-dataset.txt&#39;</span>)</span>
<span id="cb16-26"><a href="benchmarking.html#cb16-26"></a></span>
<span id="cb16-27"><a href="benchmarking.html#cb16-27"></a><span class="co"># Log metrics (here accuracy) with wandb</span></span>
<span id="cb16-28"><a href="benchmarking.html#cb16-28"></a>wandb.watch(model)</span>
<span id="cb16-29"><a href="benchmarking.html#cb16-29"></a></span>
<span id="cb16-30"><a href="benchmarking.html#cb16-30"></a><span class="co"># Here, we assume that the my-dataset.txt has been used to create a</span></span>
<span id="cb16-31"><a href="benchmarking.html#cb16-31"></a><span class="co"># train_loader</span></span>
<span id="cb16-32"><a href="benchmarking.html#cb16-32"></a></span>
<span id="cb16-33"><a href="benchmarking.html#cb16-33"></a>model.train()</span>
<span id="cb16-34"><a href="benchmarking.html#cb16-34"></a><span class="cf">for</span> batch_idx, (data, target) <span class="kw">in</span> <span class="bu">enumerate</span>(train_loader)</span>
<span id="cb16-35"><a href="benchmarking.html#cb16-35"></a>    <span class="cf">if</span> batch_idx <span class="op">%</span> args.log_interval <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb16-36"><a href="benchmarking.html#cb16-36"></a>        wandb.log({<span class="st">&quot;Test Accuracy&quot;</span>: correct <span class="op">/</span> total, <span class="st">&quot;Test Loss&quot;</span>: loss})</span>
<span id="cb16-37"><a href="benchmarking.html#cb16-37"></a></span>
<span id="cb16-38"><a href="benchmarking.html#cb16-38"></a><span class="co"># Save model to wandb</span></span>
<span id="cb16-39"><a href="benchmarking.html#cb16-39"></a>torch.save(model.state_dict(), os.path.join(wandb.run.<span class="bu">dir</span>, <span class="st">&#39;model.pt&#39;</span>))</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="doc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="putting-it-all-together.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-Benchmarking.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
